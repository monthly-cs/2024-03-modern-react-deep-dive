# 모던 리액트 딥다이브 week3
# 2024-03-20 DIL

|주차|DIL 범위|날짜|개인 진도|
|------|---|---|---|
| 3주차 |6장, 7장|2024-03-20|447-468p|



# 7장 크롬 개발자 도구를 활용한 애플리케이션 분석

#### 프라이빗 모드 : 웹사이트를 제대로 디버깅 하고 싶다면 추천
각종 확장 프로그램이 디버깅하는데 방해가 될 수 있다.

## 크롬 개발자 도구



### 요소 화면

#### 요소 화면-왼쪽

- 웹페이지 요소의 구조확인가능

#### 요소 화면-오른쪽 

- 직접 수정이 가능하다: 태그명, 클래스, 스타일 등
- 디버깅 할 수 있다: 동적으로 제어되는 DOM이 있다면 요소의 중단점을 사용해 디버깅할 수 있다.
- 브라우저에서 해당 DOM이 왜 이런 모습으로 페인팅됐는지 모든 단서 확인 가능.
- DOM에 추가되어 있는 이벤트 리스너, 접근성 등 관련된 모든 정보 확인 가능.


### 소스 탭

- 웹 애플리케이션을 불러오기 위해 실행하거나 참조된 모든 파일을 직접 열어 확인할 수 있다.
- 소스 중단점을 생성해 다음 코드 시작을 중단하여 이전에 할당한 변수에 어떤 값이 들어있는지 확인이 가능하다.
- 사용 중인 라이브러리에서 버그가 의심되는 지점을 디버깅하거나
- 실제로 소스 코드상에서 어떤 식으로 작동하는지 확인하고 싶을 때 매우 유용함.
- 굳이 console.log로 디버깅할 필요 없이 빠르게 필요한 정보를 얻을 수 있음.
- 변수의 값을 미리 보여주는 기능, 감시에 변수를 추가해 실제 변숫값을 확인하는 기능을 사용

### 네트워크 탭

- HTTP 요청~웹 소켓에 이르기까지 웹페이지가 외부 데이터와 통신하는 정보 제공.
- 보고 싶은 네트워크 요청 종류를 필터링.
- 페이지가 로딩되는 과정을 대략적으로 확인 가능
- 외부 CDN에서 가져오는 이미지 리소스 확인 가능: 콘텐츠 우선적 다운로드 

**gzip brocoli를 활용하여 이미지/리소스 압축.


### 메모리 탭
- 현재 웹페이지가 차지하고 있는 메모리 관련 정보 확인 가능.


#### 프로파일링 유형 3가지

- 힙 스냅샷
- 타임라인
- 할당 샘플링


##### 힙 스냅샷

- 현재 페이지의 메모리 상태를 확인해볼 수 있음.
- 확인 방법: 의심이 가는 지점을 추측 후, 스냅샷 두개 이상(전후 내용) 촬영하여 그 차이만 비교한다.

##### 힙 스냅샷을 통해 확인할 수 있는 구체적인 내용

- 어떤 이유로 메모리 사용량 차이가 발생했는지.
- 메모리를 크게 차지하고 있는 것은 무엇인지.
- 해당 객체가 어떠한 값을 가지고 있는지. ex. 의존성 있는 값들 useMemo or useCallback 등 렌더링 사이에 유지되는지 육안으로 확인가능.


#### 타임라인 할당계측

- 시간의 흐름에 따라 메모리의 변화를 모두 기록 : 많은 부담 발생.
- 기간을 좁혀 해당 기간 메모리에 할당된 내용만 골라서 볼 수 있음.
- 특정 변수를 클릭해 전역변수로 저장 : 해당 변수의 값을 확인할 수 있음.

##### 타임라인을 통해 확인할 수 있는 구체적인 내용

- 메모리 변화를 일으킨 변수가 무엇인지 확인 가능.
- 해당 변수가 어느정도 크기를 가지고 있는지 확인 가능.


#### 할당 샘플링

- 시간의 흐름에 따라 발생하는 메모리 점유율 확인가능.(타임라인 할당계측)
- 자바스크립트 실행 스택별로 분석 가능(함수 단위).
- 장기간에 걸쳐 디버깅을 수행해야 할 때 유용.
- 타임라인과 다르게 브라우저에 주는 부담을 최소화할 수 있다.


### Next.js 환경 디버깅하기

서버 환경도 동일하게 크롬개발자 도구로 디버깅 가능.

1. Next.js를 디버그 모드로 실행한다.
2. open dedicated DevTools for Node를 클릭

#### 서버에서 메모리 누수 여부 확인 방법
- 서버를 실행한 뒤 사용자가 유입되면서 발생하기 때문에 직접 트래픽을 발생시켜서 확인하는 것이 확실하다.
- 오픈소스 도구인 ab를 사용 : HTTP 서버의 성능을 벤치마킹할 수 있는 도구.
  ※ 반드시 IP나 올바른 주소 기재해야 함.(localhost X.)


### 디버깅 할 때

- 대부분의 경우 누수의 원인이 불명확함 + 코드를 아무리 봐도 잘 이해되지 않음.
- 많은 가능성을 열어두고 볼 것 : 내 코드일 수도, npm 라이브러리 일 수도.. 



