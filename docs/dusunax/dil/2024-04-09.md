# DIL: ëª¨ë˜ ë¦¬ì•¡íŠ¸ ë”¥ ë‹¤ì´ë¸Œ, 6ì£¼ì°¨-2

> ìŠ¤í„°ë””: ì›”ê°„ CS, https://github.com/monthly-cs/2024-03-modern-react-deep-dive  
> ì˜¤ëŠ˜ ì§„í–‰: ê°œì¸ê³µë¶€

---

## DIL-week6-\2_2024-04-09

| DIL ì£¼ì°¨ | ë²”ìœ„       | ë‚´ìš©                                                      | ì˜¤ëŠ˜ì°¨ ì§„ë„ |
| -------- | ---------- | --------------------------------------------------------- | ----------- |
| 6ì£¼ì°¨    | 10ì¥, 11ì¥ | ë¦¬ì•¡íŠ¸ 17ê³¼ 18 ë³€ê²½ ì‚¬í•­ ì‚´í´ë³´ê¸°, Next.js 13ê³¼ ë¦¬ì•¡íŠ¸ 18 | 657p~       |

> `ì˜¤ëŠ˜ ì½ì€ ë‚´ìš©ì„ markdownìœ¼ë¡œ ê°„ë‹¨íˆ ë©”ëª¨`  
> ì½ì€ ì‹œê°„: 8ì‹œ~

---

## ë¦¬ì•¡íŠ¸ 17ê³¼ 18 ë³€ê²½ ì‚¬í•­ ì‚´í´ë³´ê¸°

### ë¦¬ì•¡íŠ¸ 17

- 16 => 17
  - ë¦¬ì•¡íŠ¸íŒ€ ì™ˆ, 10ë§Œ ê°œì˜ ì»´í¬ë„ŒíŠ¸ ì¤‘ í˜¸í™˜ì„±ì´ ê¹¨ì§€ëŠ” ë³€ê²½ ì‚¬í•­ì€ 20ê°œ ë¯¸ë§Œì´ë¼ í•¨

#### ì ì§„ì  ì—…ê·¸ë ˆì´ë“œ

- ë ˆê±°ì‹œ ì• í”Œë¦¬ì¼€ì´ì…˜ ê´€ë¦¬ > ì§€ì› ì¤‘ë‹¨ëœ API ê³ ì¹˜ëŠ” ì‘ì—… > ë²ˆê±°ë¡œì›€
- 17ë¶€í„° ì¼ë¶€ íŠ¸ë¦¬ + ì»´í¬ë„ŒíŠ¸ì— ëŒ€í•´ì„œë§Œ 18ì„ ì„ íƒí•˜ëŠ” "ì ì§„ì  ì—…ê·¸ë ˆì´ë“œ"ê°€ ê°€ëŠ¥í•˜ë‹¤..
- ì—…ê·¸ë ˆì´ë“œê°€ ë„ˆë¬´ ë¶€ë‹´ì´ ë˜ëŠ” ì• í”Œë¦¬ì¼€ì´ì…˜ì˜ ê²½ìš° ê³ ë ¤
  - ì´ëŸ° ì´ìœ ë¡œ 17ë²„ì „ìœ¼ë¡œ ì—…ë°ì´íŠ¸í•œë‹¤ë©´ ì—…ë°ì´íŠ¸ë¥¼ ìœ„í•œ ì—…ë°ì´íŠ¸ë¼ í•  ìˆ˜ ìˆìŒ

#### í•œ ì• í”Œë¦¬ì¼€ì´ì…˜ ë‚´ì— ì—¬ëŸ¬ ë²„ì „ì˜ ë¦¬ì•¡íŠ¸ê°€ ì¡´ì¬í•˜ëŠ” ì‹œë‚˜ë¦¬ì˜¤

- https://github.com/wikibook/react-deep-dive-example/tree/main/chapter10/react-gradual-demo
  - mordern(17)ê³¼ legacy(16)ë¡œ êµ¬ì„±ëœ ì˜ˆì œ ë ˆí¬
    - mordern ì• í”Œë¦¬ì¼€ì´ì…˜ì´ legacy ì• í”Œë¦¬ì¼€ì´ì…˜ì„ lazyë¡œ ë¶ˆëŸ¬ì˜¨ë‹¤.
    - ë¦¬ì•¡íŠ¸ 16ì„ ìœ„í•œ ë£¨íŠ¸ ìš”ì†Œë¥¼ ë§Œë“œëŠ” HOC lazyLegacyRoot
      - ëœë”ë§ ê³¼ì •ì—ì„œ ë²„ì „ ë¶ˆì¼ì¹˜ë¡œ ì¸í•œ ì—ëŸ¬ ë°œìƒx
      - ë‘ ê°œì˜ ë¦¬ì•¡íŠ¸ ë£¨íŠ¸ëŠ” -> ì»´í¬ë„ŒíŠ¸, í›…, Contextë¥¼ ì„œë¡œ ë¶ˆëŸ¬ì™€ì„œ ì‚¬ìš©í•  ìˆ˜ ìˆë‹¤
- ì–´ë””ê¹Œì§€ë‚˜ ì°¨ì„ ì±…

#### ì´ë²¤íŠ¸ ìœ„ì„ ë°©ì‹ì˜ ë³€ê²½ğŸ¤”

- ì–´ë–»ê²Œ?

```tsx
import { useEffect, useRef } from "react";

export default function Button() {
  const buttonRef = useRef<HTMLButtonElement | null>(null);

  useEffect(() => {
    if (buttonRef.current) {
      buttonRef.current.onclick = function ìê°ˆì¹˜() {
        alert("ğŸ™");
      };
    }
  }, []);

  function ì˜¤ì‚¬ì¯”() {
    alert("ğŸ ");
  }

  return (
    <>
      {/* ë¦¬ì•¡íŠ¸ ì• í”Œë¦¬ì¼€ì´ì…˜ì—ì„œ DOMì— onClick ì´ë²¤íŠ¸ë¥¼ ì¶”ê°€í•˜ëŠ” ë°©ì‹ */}
      {/* handler: noop(), no operation, ì•”ê²ƒë„ í•˜ì§€ ì•ŠìŒ */}
      <button onClick={ì˜¤ì‚¬ì¯”}>ë¦¬ì•¡íŠ¸ ë²„íŠ¼</button>

      {/* DOMì„ ì°¸ì¡°í•œ ë‹¤ìŒ, DOMì˜ onclickì— ì§ì ‘ í•¨ìˆ˜ ì¶”ê°€í•˜ëŠ” ê³ ì „ì ì¸ ì´ë²¤íŠ¸ í•¸ë“¤ëŸ¬ ì¶”ê°€ ë°©ì‹ */}
      {/* handler: ìê°ˆì¹˜() */}
      <button ref={buttonRef}>DOM ë²„íŠ¼</button>
    </>
  );
}
```

#### ë¦¬ì•¡íŠ¸ì™€ ì´ë²¤íŠ¸ í•¸ë“¤ëŸ¬, ì´ë²¤íŠ¸ ìœ„ì„

- í•´ë‹¹ ì´ë²¤íŠ¸ í•¸ë“¤ëŸ¬ë¥¼ ì¶”ê°€í•œ ê°ê°ì˜ DOM ìš”ì†Œì— ë¶€ì°©x
- ì´ë²¤íŠ¸ íƒ€ì…ë‹¹ í•˜ë‚˜ì˜ í•¸ë“¤ëŸ¬ë¥¼ ë£¨íŠ¸ì— ë¶€ì°©í•œë‹¤
- ì´ë²¤íŠ¸ êµ¬ì„± ë‹¨ê³„
  | ë‹¨ê³„ | ë‚´ìš© |
  | --- | --- |
  | capture | ì´ë²¤íŠ¸ í•¸ë“¤ëŸ¬ê°€ íŠ¸ë¦¬ ìµœìƒë‹¨ ìš”ì†Œì—ì„œë¶€í„°, ì‹¤ì œ ì´ë²¤íŠ¸ê°€ ë°œìƒí•œ íƒ€ê¹ƒ ìš”ì†Œê¹Œì§€ ë‚´ë ¤ê°€ëŠ” ê²ƒ |
  | target | ì´ë²¤íŠ¸ í•¸ë“¤ëŸ¬ê°€ íƒ€ê¹ƒ ë…¸ë“œì— ë„ë‹¬ / ì´ë²¤íŠ¸ í˜¸ì¶œ |
  | bubbling | ì´ë²¤íŠ¸ê°€ ë°œìƒí•œ ìš”ì†Œì—ì„œë¶€í„° ìµœìƒìœ„ ìš”ì†Œê¹Œì§€ ì˜¬ë¼ê°€ëŠ” ê²ƒ |
- ë¦¬ì•¡íŠ¸ì˜ ê²½ìš°, ìµœì´ˆ ë¦´ë¦¬ì¦ˆë¶€í„° event delegationì„ ì ê·¹ì ìœ¼ë¡œ ì‚¬ìš©í–ˆë‹¤. ì´ë²¤íŠ¸ë¥¼ **ê° ìš”ì†Œê°€ ì•„ë‹Œ documentì— ì—°ê²°**í•´ì„œ ì´ë²¤íŠ¸ë¥¼ ë” íš¨ìœ¨ì ìœ¼ë¡œ ê´€ë¦¬í•œë‹¤.
  - 16ë²„ì „ê¹Œì§€ëŠ” document, 17ë¶€í„°ëŠ” ë¦¬ì•¡íŠ¸ ì»´í¬ë„ŒíŠ¸ ìµœìƒë‹¨ íŠ¸ë¦¬(root element)
    - ì ì§„ì  ì—…ê·¸ë ˆì´ë“œ ì§€ì›
      - ëª¨ë“  ì´ë²¤íŠ¸ê°€ docuemnetì— ìˆìŒ
      - ë‹¤ë¥¸ ë²„ì „ì˜ ë¦¬ì•¡íŠ¸ë¥¼ ì‚¬ìš©í•˜ëŠ” ë£¨íŠ¸ ìš”ì†Œì—ì„œ ì´ë²¤íŠ¸ ì „íŒŒë¥¼ ë§‰ì„ ìˆ˜ ì—†ë‹¤
      - ë”°ë¼ì„œ ì´ë²¤íŠ¸ë¥¼ í•´ë‹¹ ë¦¬ì•¡íŠ¸ ì»´í¬ë„ŒíŠ¸ íŠ¸ë¦¬ ìˆ˜ì¤€ìœ¼ë¡œ ê²©ë¦¬í•˜ì—¬ ì´ë²¤íŠ¸ ë²„ë¸”ë§ í˜¼ì„ ì„ ë§‰ìŒ
      - ì ì§„ì  ì—…ê·¸ë ˆì´ë“œ ë¿ë§Œ ì•„ë‹ˆë¼ JQuery ë“± ë‹¤ë¥¸ ë¼ì´ë¸ŒëŸ¬ë¦¬ì—ë„ í†µìš©ë¨
    - ê·¸ë˜ì„œ ë¦¬ì•¡íŠ¸ 16ë²„ì „ì—ì„œ root elementì— event stopPropagationí•˜ë©´ ëª¨ë“  ì´ë²¤íŠ¸ë¥¼ ë§‰ì„ ìˆ˜ ìˆì—ˆë‹¤~
- document.addEventListenerë¥¼ í™œìš©í•´ ë¦¬ì•¡íŠ¸ì˜ ëª¨ë“  ì´ë²¤íŠ¸ë¥¼ documentì—ì„œ í™•ì¸í•˜ëŠ” ì½”ë“œê°€ ìˆë‹¤? > ì´ë²¤íŠ¸ê°€ documentê¹Œì§€ ì „íŒŒë˜ì§€ ì•ŠëŠ” ê²½ìš° ìˆìŒ

#### JSX transfrom

- JSXëŠ” ë¸Œë¼ìš°ì €ê°€ ì´í•´í•  ìˆ˜ ìˆëŠ” ì½”ë“œê°€ ì•„ë‹˜
  - ë°”ë²¨, íƒ€ì…ìŠ¤í¬ë¦½íŠ¸ ì»´íŒŒì¼
- 16ê¹Œì§€ëŠ” JSX ë³€í™˜ì„ ìœ„í•´ 'react' importê°€ í•„ìš”í–ˆê³ , ì—†ìœ¼ë©´ ì—ëŸ¬ì˜€ë‹¤, react.createElement
- 17ë¶€í„°ëŠ” ë°”ë²¨ê³¼ í˜‘ë ¥í•´ ì´ëŸ¬í•œ import êµ¬ë¬¸ ì—†ì´ë„ JSX ë³€í™˜, \_jsxRuntime
  - import ì‚­ì œí•˜ë‹ˆê¹Œ ë²ˆë“¤ë§ í¬ê¸° ì¡°ê¸ˆì´ë‚˜ë§ˆ ì¤„ì„
  - ì»´í¬ë„ŒíŠ¸ ì‘ì„± ê°„ê²°í™”. ë‚´ë¶€ ë¡œì§ë˜í•œ ê°„ê²°í•˜ë‹¤.
- ê·¸ëŸ¬ë¯€ë¡œ import React ì§€ìš°ê³ , tsconfig.jsonì˜ jsxëŠ” "react-jsx"

#### event pooling ì œê±°

- ë¦¬ì•¡íŠ¸ 16ì˜ ì´ë²¤íŠ¸ í’€ë§
  - SyntheticEvent í’€ì„ ë§Œë“¤ì–´ì„œ, ì´ë²¤íŠ¸ê°€ ë°œìƒí•  ë•Œë§ˆë‹¤ ê°€ì ¸ì˜¨ ê²ƒì„ ì˜ë¯¸
- SyntheticEvent: ë¸Œë¼ìš°ì €ì˜ ê¸°ë³¸ ì´ë²¤íŠ¸ë¥¼ í•œ ë²ˆ ë” ê°ì‹¼ ì´ë²¤íŠ¸ ê°ì²´
  - í•œ ë²ˆ ë˜í•‘í•œ ì´ë²¤íŠ¸ë¥¼ ì‚¬ìš©í•˜ê¸° ë•Œë¬¸ì—, ì´ë²¤íŠ¸ê°€ ë°œìƒí•  ë•Œë§ˆë‹¤ ì´ë²¤íŠ¸ë¥¼ ìƒˆë¡œ ë§Œë“¤ì–´ì•¼ í•˜ë¯€ë¡œ -> ë©”ëª¨ë¦¬ í• ë‹¹ ì‘ì—…
  - ë©”ëª¨ë¦¬ ëˆ„ìˆ˜ë¥¼ ë°©ì§€í•˜ê¸° ìœ„í•´ ì£¼ê¸°ì ìœ¼ë¡œ í•´ì œí•˜ëŠ” ë²ˆê±°ë¡œì›€
- ì´ë²¤íŠ¸ í’€ë§ ì‹œìŠ¤í…œ
  1. ì´ë²¤íŠ¸ í•¸ë“¤ëŸ¬ê°€ ì´ë²¤íŠ¸ë¥¼ ë°œìƒ ì‹œí‚´
  2. í•©ì„± ì´ë²¤íŠ¸ í’€ì—ì„œ í•©ì„± ì´ë²¤íŠ¸ ê°ì²´ì— ëŒ€í•œ ì°¸ì¡°ë¥¼ ê°€ì ¸ì˜´
  3. ì´ë²¤íŠ¸ ì •ë³´ë¥¼ í•©ì„± ì´ë²¤íŠ¸ ê°ì²´ì— ë„£ëŠ”ë‹¤
  4. ìœ ì €ê°€ ì§€ì •í•œ ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ ì‹¤í–‰
  5. ì´ë²¤íŠ¸ ê°ì²´ ì´ˆê¸°í™” => ë‹¤ì‹œ ì´ë²¤íŠ¸ í’€...
- ì´ë²¤íŠ¸ê°€ ì¢…ë£Œë˜ìë§ˆì ì´ˆê¸°í™”í•˜ëŠ” ë°©ì‹ì€ ì§ê´€ì ì´ì§€ ì•Šì•˜ë‹¤. ã… ã… 
- ì´ë²¤íŠ¸ í’€ë§ ë°©ì‹ìœ¼ë¡œ, ì´ë²¤íŠ¸ ê°ì²´ë¥¼ ì‚¬ìš©í•œë‹¤.
  - ì¬ì‚¬ìš© ì‚¬ì´ì— ëª¨ë“  ì´ë²¤íŠ¸ í•„ë“œë¥¼ nullë¡œ ë³€ê²½(ì¬ì‚¬ìš©ì„ ìœ„í•´ ì´ˆê¸°í™”)
  - ì´ˆê¸°í™”ëœ ì´í›„ì— eì— ì ‘ê·¼í•˜ë©´ null
    - e.persist()ê°™ì€ ë³„ë„ ì²˜ë¦¬ê°€ í•„ìš”í•˜ë‹¤
- ì¦‰, ë³„ë„ ë©”ëª¨ë¦¬ ê³µê°„ì— í•©ì„± ì´ë²¤íŠ¸ ê°ì²´ë¥¼ í• ë‹¹í•´ì•¼ í•œë‹¤. ì„±ëŠ¥ í–¥ìƒì— ë„ì›€ì´ ë˜ì§€ ì•Šìœ¼ë¯€ë¡œ event pooling ê°œë…ì´ ì‚­ì œë˜ì—ˆë‹¤. ë˜í•œ ëª¨ë˜ ë¸Œë¼ìš°ì € ì„±ëŠ¥ì´ ê°œì„ ë˜ì–´, ì´ë²¤íŠ¸ í•¸ë“¤ëŸ¬ ë‚´ë¶€ì—ì„œ ì´ë²¤íŠ¸ ê°ì²´ì— ì ‘ê·¼í•  ë•Œ ë¹„ë™ê¸°ë“  ë™ê¸°ë“  ìƒê´€ì—†ìŒ

#### useEffect í´ë¦°ì—… í•¨ìˆ˜ì˜ ë¹„ë™ê¸° ì‹¤í–‰

- useEffectì˜ í´ë¦°ì—… í•¨ìˆ˜ëŠ” 16ë²„ì „ê¹Œì§€ëŠ” ë™ê¸°ì˜€ë‹¤
  - ë¶ˆí•„ìš”í•œ ì„±ëŠ¥ ì €í•˜ê°€ ë°œìƒí–ˆë‹¤
- 17ë¶€í„°ëŠ” í™”ë©´ì´ ì™„ì „íˆ ì—…ë°ì´íŠ¸ ëœ ì´í›„ì— í´ë¦°ì—… í•¨ìˆ˜ê°€ ë¹„ë™ê¸°ì ìœ¼ë¡œ ì‹¤í–‰ëœë‹¤.
  - í´ë¦°ì—… í•¨ìˆ˜ëŠ” ì»´í¬ë„ŒíŠ¸ì˜ ì»¤ë°‹ ë‹¨ê³„ê°€ ì™„ë£Œë  ë•Œê¹Œì§€ ì§€ì—°ëœë‹¤
  - "í™”ë©´ì˜ ì—…ë°ì´íŠ¸ê°€ ì™„ì „íˆ ëë‚œ ì´í›„"ì— ì‹¤í–‰ë˜ë„ë¡ ë°”ë€Œì—ˆìœ¼ë©°, ì„±ëŠ¥ì  ì´ì ì´ ë˜ì—ˆë‹¤
    - => Profilerë¡œ commitTime í™•ì¸í•  ìˆ˜ ìˆìŒ

#### Profiler

> https://react.dev/reference/react/Profiler  
> `<Profiler>` lets you measure rendering performance of a React tree programmatically.

```tsx
<Profiler id="App" onRender={onRender}>
  <App />
</Profiler>
```

- ì½˜ì†” í…Œì´ë¸” ì°ìœ¼ë©´ì„œ í¼í¬ë¨¼ìŠ¤ í™•ì¸ ê°€ëŠ¥ << ì‹ ê¸°í•¨

#### ì»´í¬ë„ŒíŠ¸ì˜ undefined ë°˜í™˜ì— ëŒ€í•œ ì¼ê´€ì  ì²˜ë¦¬

| react  | ì¼€ì´ìŠ¤                                                           | ì—ëŸ¬ ì—¬ë¶€ |
| ------ | ---------------------------------------------------------------- | --------- |
| 16, 17 | ì»´í¬ë„ŒíŠ¸ê°€ undefinedë¥¼ ë°˜í™˜                                      | O         |
| 16     | memo, forwardRefê°€ undefinedë¥¼ ë°˜í™˜                              | X         |
| 17     | memo, forwardRefê°€ undefinedë¥¼ ë°˜í™˜                              | O         |
| 18     | ì»´í¬ë„ŒíŠ¸ê°€ undefinedë¥¼ ë°˜í™˜, memo, forwardRefê°€ undefinedë¥¼ ë°˜í™˜ | X         |

#### 17.0.0 ë” ì‚´í´ë³´ê¸°

- https://github.com/facebook/react/releases/tag/v17.0.0
- ë¦¬ì•¡íŠ¸ 16 í”„ë¡œì íŠ¸ê°€ ìˆë‹¤ë©´ 17ë¡œ ì—…ë°ì´íŠ¸ í•˜ëŠ” ê²ƒì´ ì¢‹ë‹¤
  - ì ì§„ì  ì—…ê·¸ë ˆì´ë“œ ëŒ€ë¹„
  - ê³µìˆ˜ê°€ í¬ê¸° ì•ŠìŒ
