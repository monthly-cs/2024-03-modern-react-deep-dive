# 2024-03-21

## 7.6 Next.js 환경 디버깅하기

### 7.6.1 Next.js 프로젝트를 디버그 모드로 실행하기

```tsx
"dev": NODE_OPTIONS='--inspect' next dev
```

### 7.6.2 Next.js 서버에 트래픽 유입시키기

서버 사이드 렌더링과 같이 서버에서 제공되는 서비스의 경우 서버를 실행한 뒤 사용자가 서서히 유입되면서 메모리 누수가 발생하는 경우가 많다. 따라서 서버에 직접 트래픽을 발생시켜서 확인하는 편이 제일 확실한 방법이다.

사용자의 트래픽이 서버로 몰리는 상황을 시뮬레이션하기 위해서는 새로고침이나 다른 컴퓨터를 이용해서 접속하는 방법보다는 오픈소스 도구인 ab사용하는 편이 좋음.

ab를 사용하면 단순히 요청을 수행하는 것뿐만 아니라 요청으로부터 응답받는 데 걸린 시간, 바이트 크기등 다양한 정보를 확인할 수 있다.

### 7.6.3 Next.js의 메모리 누수 지점 확인하기

getServerSideProps는 페이지 접근 요청이 있을 때마다 실행되는 함수이므로 최대한 부수 효과가 없는 순수 함수로 만ㄷ르어야 한다. 만약 이 함수 내부에서 외부 스코프의 변수에 의존하는 작업을 한다면 지금과 같은 메모리 누수 상황을 마주할 수도 있을 것이다.